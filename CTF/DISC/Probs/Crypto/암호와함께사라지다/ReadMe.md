# 암호화함께사라지다
680 point

## Overview
대회를 앞두고 성훈이가 사라졌다. 책상에는 RSA 공개키 알고리즘 내용이 나온 실용암호학 책이 펼쳐져 있다. 책상엔 희미하게 연필로 적은 이상한 수가 나열되어 있다. 읽을수는 없어보이는데.. 여기에 무슨 뜻이 있는걸까?  


(성훈이의 공개키 : (107, 493))  


408, 108, 111, 254, 81, 408, 143, 75, 349, 122, 238, 223, 217, 147, 58, 367, 143, 223, 235, 94, 463, 235, 331, 147, 11, 468, 102, 219, 11, 210, 237, 80  

HINT : 책상에 적힌 숫자는 성훈이가 개인키로 암호화 시키고 얻은 암호문입니다.  

## Solution
문제에서 이것은 **RSA 공개키 알고리즘** 이에요!! 라고 말했다.  

A와 B가 있을 때 B가 개인키를 가지고 있고 A는 공개키를 가지고 B에게 보내는 입장이라고 할 때
A가 **공개키 e**로 **[m^e mod n]** 한 암호문 c를 B에게 보내면 B는 자신이 가지고 있는 **개인키 d** 로 **[c^d mod n]** 의 연산을 통해 원래의 평문을 되찾는다.  

하지만 도청 하고자하는 사람 C는 개인키가 없으므로 평문으로 만들 수 없다.  

이것이 RSA의 본래 원리이다.  

근데 문제에서 개인키로 암호화 하였다고 했다.  
그랬을 때 개인키가 e가 되고 e를 d로 취급하여 해독하면  
플래그가 나온다!  

헷갈렸던 부분  
- ^는 제곱, 승을 의미한다. XOR 연산이 아니다!!
- e는 고정되있는 것이 아닌 선택이다. 그에 따라 d도 바뀔 수 있다.

> 은근히 간단한데 이거 깨닫는 데 3시간 정도 걸렸나..?  

참고문서 : wiki, 해커스쿨

### Python Code

```Python
#-*-coding:utf8-*-

d = int(raw_input("Input d :"))
n = int(raw_input("Input n :"))
string = raw_input("Input String :").split(",")
string = [int(c) for c in string]

result = ""
for c in string:
    result += chr( c ** d % n )

print result
```

아래는 실행결과이다.  

```console
> python .\decrypt.py
Input d :107
Input n :493
Input String :408, 108, 111, 254, 81, 408, 143, 75, 349, 122, 238, 223, 217, 147, 58, 367, 143, 223, 235, 94, 463, 235, 331, 147, 11, 468, 102, 219, 11, 210, 237, 80
DISC{D0cum3n7ati0n_1s_hardwork!}
```

## Flag
DISC{D0cum3n7ati0n_1s_hardwork!}
